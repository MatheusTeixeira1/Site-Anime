<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="icon" type="image/x-icon" href="../public/images/animeray-logo.jpg">
    <link rel="stylesheet" href="profileEditEmail.css">
    <link rel="stylesheet" href="../public/styles/all.css">
    <link rel="stylesheet" href="../public/styles/footer.css">
    <link rel="stylesheet" href="../public/styles/header.css">
</head>

<body id="body">
    <video class="background-video" autoplay loop muted>
        <source src="../public/videos/Background.mp4" type="video/mp4">
        Seu navegador n√£o suporta v√≠deos HTML5.
    </video>

    <div id="popupMenu">
        <ul>
            <li class="profileButton">Meu perfil</li>
            <li class="favoritesButton">Lista de Favoritos</li>
            <li class="adminButton">Area do Adm</li>
            <li class="logoutButton">Sair</li>
        </ul>
    </div>
    <div id="backgorundPopUpMenu">
    </div>

    <header>
        <a id="brandLogoContainer" href="#">
            <img id="brandLogo" src="../public/images/animeray-logo.jpg" alt="">
            <h2>ANIMERAY</h2>
        </a>
        <div id="containerOppenPopUpMenu">
            <img class="profileImage" id="profileImage" src="../public/images/perfil-padrao.png" alt="">
            <svg id="svgArrow" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
                <path fill="#ccc" transform="rotate(180 8 8)"
                    d="M8 10L8 14L6 14L-2.62268e-07 8L6 2L8 2L8 6L16 6L16 10L8 10Z" fill="#000000" />
            </svg>
        </div>
    </header>
    <main>
        <form action="" id="formEditUser">
            <div class="labelinputImageContainer">
                <label for="inputImage" class="labelinputImage">
                    <span class="spanInputImage">
                        <img class="chosenImage profileImage" src="" alt="">
                    </span>
                    <input id="inputImage" class="inputImage" type="file" accept="image/*">
                </label>
            </div>
            <div class="inputProfileContainer">
                <div class="inputProfile">
                    <label for="email">Novo Email:</label>
                    <input type="email" name="email" id="email" maxlength="255">
                </div>
                <div class="inputProfile">
                    <label for="password">Confirme Sua senha:</label>
                    <input type="text" name="password" id="password" maxlength="255">
                </div>
            </div>

            <div class="buttonsContainer">
                <button type="submit">Salvar</button>
                <button>Cancelar</button>
            </div>
        </form>
    </main>
    <footer>
        <div class="footer-container">
            <div class="footer-sections">


                <div class="footer-section navigation">
                    <div>
                        <h3>Guia de Navega√ß√£o</h3>
                        <ul>
                            <li class="backToTop">Voltar para Topo</li>

                            <li class="adminButton">Area do Adm</li>
                            <li class="logoutButton">Trocar de Conta</li>
                            <li class="logoutButton">Sair</li>
                        </ul>
                    </div>

                </div>


                <div class="footer-section contact">
                    <div>
                        <h3>√Årea do Perfil</h3>
                        <ul>
                            <li class="profileButton">Meu Perfil</li>
                            <li class="favoritesButton">Lista de Favoritos</li>
                            <li class="favoritesButton">Deletar Minha Conta</li>
                        </ul>
                    </div>
                </div>
                <div class="footer-section contact">
                    <div>
                        <h3>Contate-me</h3>
                        <ul>
                            <li>
                                <a href="https://github.com/MatheusTeixeira1" target="_blank">
                                    Github üîóüò∫
                                </a>
                            </li>
                            <li>
                                <a href="https://www.linkedin.com/in/matheusteixeirap/" target="_blank">
                                    Linkedin üîóüíº
                                </a>
                            </li>
                            <li>
                                <span>mathesteix@gmail.com</span>
                                <a href="mailto:mathesteix@gmail.com">‚Üíüîóüìß</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="footer-credits">
                <p>Criador: <strong>Matheus Teixeira</strong></p>
                <p>Site: <strong>ANIMERAY</strong></p>
            </div>
        </div>
    </footer>
    <script src="../public/scripts/navigation.js"></script>
    <script src="../public/scripts/auth.js"></script>
    <script src="../public/scripts/api.js"></script>
    <script src="../public/scripts/dynamicComponents.js"></script>
    <script src="profileEditEmail.js"></script>

    <script>



        document.getElementById('formEditUser').addEventListener('submit', async (e) => {
            e.preventDefault()

            const url = `http://localhost:8080/user/updatePassword/${payload.id}`; // Ajuste a porta se necess√°rio

            newUsername = document.getElementById('email').value;
            password = document.getElementById('password').value;

            const body = {
                email: newUsername,
                password: password
            };

            try {
                const response = await fetch(url, {
                    method: "PATCH",
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify(body),
                });

                sessionStorage.removeItem('token');
                window.location.href = '../login/login.html'; // Navega para a pr√≥xima tela

            } catch (error) {
                console.error("Erro ao se conectar ao servidor:", error);
            }
        });



        async function updateUsername(userId, newUsername, password) {


        }

    

















        const inputFile = document.getElementById('inputImage');
        const pictureImage = document.querySelector('.spanInputImage');


        inputFile.addEventListener('change', function (e) {
            const inputTarget = e.target;
            const file = inputTarget.files[0];
            if (file) {
                const reader = new FileReader();

                reader.addEventListener('load', function (e) {
                    const readerTarget = e.target;


                });

                reader.readAsDataURL(file);
            } else {
                pictureImage.innerHTML = pictureImageTxt;
            }
        });




        document.addEventListener('DOMContentLoaded', () => {
            if (!sessionStorage.getItem('token')) {
                window.location.href = '../login/login.html';

            } else {
                setupAdminInterface();
                //listNewAnimes();
                setupNavigation();
                setupPopUpMenu();
            }

        });
    </script>
</body>

</html>